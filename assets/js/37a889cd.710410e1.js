"use strict";(globalThis.webpackChunkphysical_ai_robotics_book=globalThis.webpackChunkphysical_ai_robotics_book||[]).push([[210],{1473(e,n,s){s.d(n,{A:()=>m});s(6540);var i=s(4164);const t="container_DYDm",r="header_yOrC",c="titleSection_jiBk",o="icon_OiJW",a="title_bD_B",l="meta_N7Me",d="time_Cevp",u="difficulty_aRrW",p="content_CCam";var h=s(4848);const m=({title:e,time:n,difficulty:s,children:m})=>(0,h.jsxs)("div",{className:(0,i.A)("lab-activity-container",t),children:[(0,h.jsxs)("div",{className:r,children:[(0,h.jsxs)("div",{className:c,children:[(0,h.jsx)("span",{className:o,children:"\ud83e\uddea"}),(0,h.jsx)("h3",{className:a,children:e||"Lab Activity"})]}),(0,h.jsxs)("div",{className:l,children:[n&&(0,h.jsxs)("span",{className:d,children:["\u23f1\ufe0f ",n]}),s&&(0,h.jsxs)("span",{className:u,children:["\ud83c\udfaf ",s]})]})]}),(0,h.jsx)("div",{className:p,children:m})]})},3466(e,n,s){s.d(n,{A:()=>p});s(6540);var i=s(4164),t=s(5489);const r="container_wR2L",c="content_Ku25",o="refType_eLMv",a="refLink_Ya_s",l="description_kDwm",d="icon_D_OF";var u=s(4848);const p=({to:e,title:n,type:s="section",children:p})=>(0,u.jsxs)("div",{className:(0,i.A)("cross-reference-container",r),children:[(0,u.jsxs)("div",{className:c,children:[(0,u.jsxs)("span",{className:o,children:[s.toUpperCase(),":"]}),(0,u.jsx)(t.A,{to:e,className:a,children:n}),p&&(0,u.jsx)("div",{className:l,children:p})]}),(0,u.jsx)("span",{className:d,children:"\ud83d\udd17"})]})},6274(e,n,s){s.d(n,{A:()=>c});s(6540);var i=s(4164);const t={container:"container_O8RR",header:"header_LgZa",titleSection:"titleSection_gyi3",icon:"icon_yEVu",title:"title_gwcA",sectionTitle:"sectionTitle_DWTK",objectivesList:"objectivesList_djML",objectiveItem:"objectiveItem_L9Jm",rubricGrid:"rubricGrid_oK2H",rubricItem:"rubricItem_Y0lq",criterion:"criterion_Y4sy",scores:"scores_dKwu",score:"score_dpSq",scoreLabel:"scoreLabel_e9ZM",scoreValue:"scoreValue_nfuE",content:"content_qJ2r"};var r=s(4848);const c=({type:e="quiz",title:n,objectives:s,rubric:c,children:o})=>(0,r.jsxs)("div",{className:(0,i.A)("assessment-container",t.container),children:[(0,r.jsx)("div",{className:t.header,children:(0,r.jsxs)("div",{className:t.titleSection,children:[(0,r.jsx)("span",{className:t.icon,children:"\ud83d\udcdd"}),(0,r.jsxs)("h3",{className:t.title,children:[e.charAt(0).toUpperCase()+e.slice(1),": ",n]})]})}),s&&s.length>0&&(0,r.jsxs)("div",{className:t.objectivesSection,children:[(0,r.jsx)("h4",{className:t.sectionTitle,children:"Learning Objectives"}),(0,r.jsx)("ul",{className:t.objectivesList,children:s.map((e,n)=>(0,r.jsx)("li",{className:t.objectiveItem,children:e},n))})]}),c&&(0,r.jsxs)("div",{className:t.rubricSection,children:[(0,r.jsx)("h4",{className:t.sectionTitle,children:"Assessment Rubric"}),(0,r.jsx)("div",{className:t.rubricGrid,children:c.map((e,n)=>(0,r.jsxs)("div",{className:t.rubricItem,children:[(0,r.jsx)("div",{className:t.criterion,children:e.criterion}),(0,r.jsx)("div",{className:t.scores,children:e.scores.map((e,n)=>(0,r.jsxs)("div",{className:t.score,children:[(0,r.jsxs)("span",{className:t.scoreLabel,children:[e.label,":"]}),(0,r.jsx)("span",{className:t.scoreValue,children:e.value})]},n))})]},n))})]}),(0,r.jsx)("div",{className:t.content,children:o})]})},7516(e,n,s){s.r(n),s.d(n,{assets:()=>h,contentTitle:()=>u,default:()=>v,frontMatter:()=>d,metadata:()=>p,toc:()=>m});var i=s(4848),t=s(8453),r=s(8415),c=s(1473),o=s(3466),a=s(7944),l=s(6274);const d={sidebar_position:4},u="Chapter 3: Services and Actions",p={id:"module-1/chapter-3",title:"Chapter 3: Services and Actions",description:"Chapter Purpose",source:"@site/docs/module-1/chapter-3.md",sourceDirName:"module-1",slug:"/module-1/chapter-3",permalink:"/hackathon_project1/docs/module-1/chapter-3",draft:!1,unlisted:!1,editUrl:"https://github.com/physical-ai-robotics-book/physical-ai-robotics-book/tree/main/docusaurus/docs/module-1/chapter-3.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"textbookSidebar",previous:{title:"Chapter 2: Nodes, Topics, and Messages",permalink:"/hackathon_project1/docs/module-1/chapter-2"},next:{title:"Chapter 4: Parameters and Launch Systems",permalink:"/hackathon_project1/docs/module-1/chapter-4"}},h={},m=[{value:"Chapter Purpose",id:"chapter-purpose",level:2},{value:"Key Concepts",id:"key-concepts",level:2},{value:"Practical Demonstrations",id:"practical-demonstrations",level:2},{value:"1. Implementing a Simple Service for Robot Control",id:"1-implementing-a-simple-service-for-robot-control",level:3},{value:"2. Creating Action Server for Trajectory Execution",id:"2-creating-action-server-for-trajectory-execution",level:3},{value:"3. Client Implementation for Service and Action Calls",id:"3-client-implementation-for-service-and-action-calls",level:3},{value:"Hands-on Coding Labs",id:"hands-on-coding-labs",level:2},{value:"Objective",id:"objective",level:3},{value:"Steps",id:"steps",level:3},{value:"Expected Outcome",id:"expected-outcome",level:3},{value:"Troubleshooting Tips",id:"troubleshooting-tips",level:3},{value:"Objective",id:"objective-1",level:3},{value:"Steps",id:"steps-1",level:3},{value:"Expected Outcome",id:"expected-outcome-1",level:3},{value:"Troubleshooting Tips",id:"troubleshooting-tips-1",level:3},{value:"Objective",id:"objective-2",level:3},{value:"Steps",id:"steps-2",level:3},{value:"Expected Outcome",id:"expected-outcome-2",level:3},{value:"Troubleshooting Tips",id:"troubleshooting-tips-2",level:3},{value:"ROS 2 Packages/Tools Used",id:"ros-2-packagestools-used",level:2},{value:"Simulation vs Real-Robot Activities",id:"simulation-vs-real-robot-activities",level:2},{value:"Simulation:",id:"simulation",level:3},{value:"Real Robot:",id:"real-robot",level:3},{value:"Diagrams and Figures",id:"diagrams-and-figures",level:2},{value:"Service Communication Sequence Diagram",id:"service-communication-sequence-diagram",level:3},{value:"Action Lifecycle Diagram with Feedback",id:"action-lifecycle-diagram-with-feedback",level:3},{value:"Client-Server Interaction Patterns",id:"client-server-interaction-patterns",level:3},{value:"Checklists",id:"checklists",level:2},{value:"\u2713 Service Interface Definition Checklist",id:"-service-interface-definition-checklist",level:3},{value:"\u2713 Action Interface Definition Checklist",id:"-action-interface-definition-checklist",level:3},{value:"\u2713 Client Implementation Validation Checklist",id:"-client-implementation-validation-checklist",level:3},{value:"Glossary Terms",id:"glossary-terms",level:2},{value:"Cross-References",id:"cross-references",level:2},{value:"Optional Advanced Section",id:"optional-advanced-section",level:2},{value:"Multi-threaded Service Servers",id:"multi-threaded-service-servers",level:3},{value:"Custom Action Goal Preemption Logic",id:"custom-action-goal-preemption-logic",level:3},{value:"Assignment Tasks",id:"assignment-tasks",level:3},{value:"Submission Requirements",id:"submission-requirements",level:3},{value:"References",id:"references",level:2}];function _(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"chapter-3-services-and-actions",children:"Chapter 3: Services and Actions"}),"\n","\n","\n",(0,i.jsx)(n.h2,{id:"chapter-purpose",children:"Chapter Purpose"}),"\n",(0,i.jsx)(n.p,{children:"This chapter covers advanced communication patterns in ROS 2, specifically services for synchronous request/response communication and actions for goal-oriented asynchronous communication with feedback. Students will learn to implement service servers and clients, action servers and clients, and understand when to use each communication pattern based on system requirements."}),"\n",(0,i.jsx)(r.A,{objectives:["Implement service-based communication for synchronous requests in ROS 2","Design and implement action servers for long-running goals with feedback","Create service and action clients to interact with servers","Understand feedback and result handling in actions","Choose appropriate communication patterns based on system requirements"]}),"\n",(0,i.jsx)(n.h2,{id:"key-concepts",children:"Key Concepts"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Service-based communication for synchronous requests"}),": Understanding the request/response pattern for immediate results"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Action-based communication for long-running goals"}),": Implementing goal-oriented communication with feedback and status updates"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Client-server interaction patterns"}),": Designing proper client-server architectures in ROS 2"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Feedback and result handling in actions"}),": Managing intermediate feedback and final results in action-based communication"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"practical-demonstrations",children:"Practical Demonstrations"}),"\n",(0,i.jsx)(n.h3,{id:"1-implementing-a-simple-service-for-robot-control",children:"1. Implementing a Simple Service for Robot Control"}),"\n",(0,i.jsx)(n.p,{children:"Creating a service that allows other nodes to set robot parameters:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# robot_control_service.py\nimport rclpy\nfrom rclpy.node import Node\nfrom example_interfaces.srv import SetBool\n\nclass RobotControlService(Node):\n    def __init__(self):\n        super().__init__('robot_control_service')\n        self.srv = self.create_service(\n            SetBool,\n            'robot_control',\n            self.control_callback\n        )\n        self.get_logger().info('Robot control service is ready')\n\n    def control_callback(self, request, response):\n        if request.data:\n            self.get_logger().info('Robot activated')\n            response.success = True\n            response.message = 'Robot activated successfully'\n        else:\n            self.get_logger().info('Robot deactivated')\n            response.success = True\n            response.message = 'Robot deactivated successfully'\n\n        return response\n\ndef main(args=None):\n    rclpy.init(args=args)\n    robot_control_service = RobotControlService()\n    rclpy.spin(robot_control_service)\n    robot_control_service.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"2-creating-action-server-for-trajectory-execution",children:"2. Creating Action Server for Trajectory Execution"}),"\n",(0,i.jsx)(n.p,{children:"Implementing an action server for executing robot trajectories:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# trajectory_action_server.py\nimport time\nimport rclpy\nfrom rclpy.action import ActionServer\nfrom rclpy.node import Node\nfrom example_interfaces.action import Fibonacci\n\nclass TrajectoryActionServer(Node):\n    def __init__(self):\n        super().__init__('trajectory_action_server')\n        self._action_server = ActionServer(\n            self,\n            Fibonacci,\n            'execute_trajectory',\n            self.execute_trajectory\n        )\n\n    def execute_trajectory(self, goal_handle):\n        self.get_logger().info('Executing trajectory...')\n\n        # Feedback and result messages\n        feedback_msg = Fibonacci.Feedback()\n        feedback_msg.sequence = [0, 1]\n\n        # Simulate trajectory execution\n        for i in range(1, goal_handle.request.order):\n            if goal_handle.is_cancel_requested:\n                goal_handle.canceled()\n                self.get_logger().info('Trajectory execution canceled')\n                return Fibonacci.Result()\n\n            feedback_msg.sequence.append(\n                feedback_msg.sequence[i] + feedback_msg.sequence[i-1]\n            )\n\n            goal_handle.publish_feedback(feedback_msg)\n            time.sleep(0.1)  # Simulate work\n\n        goal_handle.succeed()\n        result = Fibonacci.Result()\n        result.sequence = feedback_msg.sequence\n        self.get_logger().info('Trajectory execution succeeded')\n        return result\n\ndef main(args=None):\n    rclpy.init(args=args)\n    trajectory_action_server = TrajectoryActionServer()\n    rclpy.spin(trajectory_action_server)\n    trajectory_action_server.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"3-client-implementation-for-service-and-action-calls",children:"3. Client Implementation for Service and Action Calls"}),"\n",(0,i.jsx)(n.p,{children:"Creating clients to interact with services and actions:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# service_client.py\nimport rclpy\nfrom rclpy.node import Node\nfrom example_interfaces.srv import SetBool\n\nclass RobotControlClient(Node):\n    def __init__(self):\n        super().__init__('robot_control_client')\n        self.cli = self.create_client(SetBool, 'robot_control')\n        while not self.cli.wait_for_service(timeout_sec=1.0):\n            self.get_logger().info('Service not available, waiting again...')\n\n        self.req = SetBool.Request()\n\n    def send_request(self, state):\n        self.req.data = state\n        self.future = self.cli.call_async(self.req)\n        rclpy.spin_until_future_complete(self, self.future)\n        return self.future.result()\n\ndef main(args=None):\n    rclpy.init(args=args)\n    robot_control_client = RobotControlClient()\n\n    # Activate robot\n    response = robot_control_client.send_request(True)\n    print(f'Response: {response.success}, {response.message}')\n\n    # Deactivate robot\n    response = robot_control_client.send_request(False)\n    print(f'Response: {response.success}, {response.message}')\n\n    robot_control_client.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h2,{id:"hands-on-coding-labs",children:"Hands-on Coding Labs"}),"\n",(0,i.jsxs)(c.A,{title:"Lab 3.1: Building a Service to Set Robot Parameters",time:"45 min",difficulty:"Medium",children:[(0,i.jsx)(n.h3,{id:"objective",children:"Objective"}),(0,i.jsx)(n.p,{children:"Create a ROS 2 service that allows other nodes to set robot parameters such as speed, direction, or operational mode."}),(0,i.jsx)(n.h3,{id:"steps",children:"Steps"}),(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Create a new service definition file (or use existing ones like SetBool, SetInt, etc.)"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Create the service server node:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# parameter_service.py\nimport rclpy\nfrom rclpy.node import Node\nfrom example_interfaces.srv import SetBool, SetInt64\n\nclass RobotParameterService(Node):\n    def __init__(self):\n        super().__init__('robot_parameter_service')\n        self.srv = self.create_service(\n            SetBool,\n            'set_robot_mode',\n            self.set_mode_callback\n        )\n        self.current_mode = False\n        self.get_logger().info('Robot parameter service ready')\n\n    def set_mode_callback(self, request, response):\n        self.current_mode = request.data\n        response.success = True\n        response.message = f'Robot mode set to {\"active\" if request.data else \"inactive\"}'\n        self.get_logger().info(f'Set robot mode: {request.data}')\n        return response\n\ndef main(args=None):\n    rclpy.init(args=args)\n    robot_parameter_service = RobotParameterService()\n    rclpy.spin(robot_parameter_service)\n    robot_parameter_service.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Build and run the service:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws\ncolcon build --packages-select your_package_name\nsource install/setup.bash\nros2 run your_package_name parameter_service\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Test the service from command line:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'ros2 service call /set_robot_mode example_interfaces/srv/SetBool "{data: true}"\n'})}),"\n"]}),"\n"]}),(0,i.jsx)(n.h3,{id:"expected-outcome",children:"Expected Outcome"}),(0,i.jsx)(n.p,{children:"A service that accepts requests to set robot parameters and responds with success status and a descriptive message."}),(0,i.jsx)(n.h3,{id:"troubleshooting-tips",children:"Troubleshooting Tips"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Ensure the service name is unique and follows ROS naming conventions"}),"\n",(0,i.jsx)(n.li,{children:"Verify that the service definition is properly installed"}),"\n"]})]}),"\n",(0,i.jsxs)(c.A,{title:"Lab 3.2: Implementing an Action Server for Trajectory Execution",time:"60 min",difficulty:"Hard",children:[(0,i.jsx)(n.h3,{id:"objective-1",children:"Objective"}),(0,i.jsx)(n.p,{children:"Create a ROS 2 action server that executes robot trajectories with feedback on progress."}),(0,i.jsx)(n.h3,{id:"steps-1",children:"Steps"}),(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Create the action server with feedback mechanism:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# trajectory_executor.py\nimport time\nimport rclpy\nfrom rclpy.action import ActionServer, CancelResponse\nfrom rclpy.node import Node\nfrom example_interfaces.action import Fibonacci\n\nclass TrajectoryExecutor(Node):\n    def __init__(self):\n        super().__init__('trajectory_executor')\n        self._action_server = ActionServer(\n            self,\n            Fibonacci,\n            'execute_trajectory',\n            self.execute_trajectory,\n            cancel_callback=self.cancel_trajectory\n        )\n\n    def cancel_trajectory(self, goal_handle):\n        self.get_logger().info('Received cancel request')\n        return CancelResponse.ACCEPT\n\n    def execute_trajectory(self, goal_handle):\n        self.get_logger().info(f'Executing trajectory with order: {goal_handle.request.order}')\n\n        feedback_msg = Fibonacci.Feedback()\n        feedback_msg.sequence = [0, 1]\n\n        for i in range(1, goal_handle.request.order):\n            if goal_handle.is_cancel_requested:\n                goal_handle.canceled()\n                self.get_logger().info('Trajectory execution canceled')\n                return Fibonacci.Result()\n\n            feedback_msg.sequence.append(\n                feedback_msg.sequence[i] + feedback_msg.sequence[i-1]\n            )\n\n            goal_handle.publish_feedback(feedback_msg)\n            self.get_logger().info(f'Feedback: {feedback_msg.sequence}')\n\n            time.sleep(0.5)  # Simulate trajectory execution time\n\n        goal_handle.succeed()\n        result = Fibonacci.Result()\n        result.sequence = feedback_msg.sequence\n        self.get_logger().info('Trajectory execution completed successfully')\n        return result\n\ndef main(args=None):\n    rclpy.init(args=args)\n    trajectory_executor = TrajectoryExecutor()\n    rclpy.spin(trajectory_executor)\n    trajectory_executor.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Build and run the action server:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd ~/ros2_ws\ncolcon build --packages-select your_package_name\nsource install/setup.bash\nros2 run your_package_name trajectory_executor\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Test the action from command line:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'ros2 action send_goal /execute_trajectory example_interfaces/action/Fibonacci "{order: 5}"\n'})}),"\n"]}),"\n"]}),(0,i.jsx)(n.h3,{id:"expected-outcome-1",children:"Expected Outcome"}),(0,i.jsx)(n.p,{children:"An action server that accepts trajectory goals, provides feedback during execution, and returns results when completed."}),(0,i.jsx)(n.h3,{id:"troubleshooting-tips-1",children:"Troubleshooting Tips"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Ensure proper handling of cancel requests"}),"\n",(0,i.jsx)(n.li,{children:"Check that feedback is published at appropriate intervals"}),"\n"]})]}),"\n",(0,i.jsxs)(c.A,{title:"Lab 3.3: Creating Clients to Interact with Services and Actions",time:"45 min",difficulty:"Medium",children:[(0,i.jsx)(n.h3,{id:"objective-2",children:"Objective"}),(0,i.jsx)(n.p,{children:"Create client nodes that can interact with the services and actions implemented in previous labs."}),(0,i.jsx)(n.h3,{id:"steps-2",children:"Steps"}),(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Create a service client:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# parameter_client.py\nimport rclpy\nfrom rclpy.node import Node\nfrom example_interfaces.srv import SetBool\n\nclass RobotParameterClient(Node):\n    def __init__(self):\n        super().__init__('robot_parameter_client')\n        self.cli = self.create_client(SetBool, 'set_robot_mode')\n        while not self.cli.wait_for_service(timeout_sec=1.0):\n            self.get_logger().info('Service not available, waiting again...')\n\n        self.req = SetBool.Request()\n\n    def send_request(self, state):\n        self.req.data = state\n        self.future = self.cli.call_async(self.req)\n        return self.future\n\ndef main(args=None):\n    rclpy.init(args=args)\n    robot_parameter_client = RobotParameterClient()\n\n    # Send request to activate robot\n    future = robot_parameter_client.send_request(True)\n    rclpy.spin_until_future_complete(robot_parameter_client, future)\n    response = future.result()\n    print(f'Activation response: {response.success}, {response.message}')\n\n    # Send request to deactivate robot\n    future = robot_parameter_client.send_request(False)\n    rclpy.spin_until_future_complete(robot_parameter_client, future)\n    response = future.result()\n    print(f'Deactivation response: {response.success}, {response.message}')\n\n    robot_parameter_client.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Create an action client:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# trajectory_client.py\nimport rclpy\nfrom rclpy.action import ActionClient\nfrom rclpy.node import Node\nfrom example_interfaces.action import Fibonacci\n\nclass TrajectoryClient(Node):\n    def __init__(self):\n        super().__init__('trajectory_client')\n        self._action_client = ActionClient(\n            self,\n            Fibonacci,\n            'execute_trajectory'\n        )\n\n    def send_goal(self, order):\n        goal_msg = Fibonacci.Goal()\n        goal_msg.order = order\n\n        self._action_client.wait_for_server()\n        self._send_goal_future = self._action_client.send_goal_async(\n            goal_msg,\n            feedback_callback=self.feedback_callback\n        )\n\n        self._send_goal_future.add_done_callback(self.goal_response_callback)\n\n    def goal_response_callback(self, future):\n        goal_handle = future.result()\n        if not goal_handle.accepted:\n            self.get_logger().info('Goal rejected')\n            return\n\n        self.get_logger().info('Goal accepted')\n        self._get_result_future = goal_handle.get_result_async()\n        self._get_result_future.add_done_callback(self.get_result_callback)\n\n    def feedback_callback(self, feedback_msg):\n        self.get_logger().info(f'Received feedback: {feedback_msg.feedback.sequence}')\n\n    def get_result_callback(self, future):\n        result = future.result().result\n        self.get_logger().info(f'Result: {result.sequence}')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    trajectory_client = TrajectoryClient()\n\n    trajectory_client.send_goal(5)\n    rclpy.spin(trajectory_client)\n\n    trajectory_client.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n"]}),"\n"]}),(0,i.jsx)(n.h3,{id:"expected-outcome-2",children:"Expected Outcome"}),(0,i.jsx)(n.p,{children:"Client nodes that can successfully interact with services and actions, sending requests/goals and receiving responses/results."}),(0,i.jsx)(n.h3,{id:"troubleshooting-tips-2",children:"Troubleshooting Tips"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Ensure the client waits for the service/action server to be available"}),"\n",(0,i.jsx)(n.li,{children:"Handle asynchronous calls properly with callbacks"}),"\n"]})]}),"\n",(0,i.jsx)(n.h2,{id:"ros-2-packagestools-used",children:"ROS 2 Packages/Tools Used"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"example_interfaces"}),": Standard ROS 2 interfaces for services and actions"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"rclpy.action"})," and ",(0,i.jsx)(n.code,{children:"rclcpp::action"}),": ROS 2 client libraries for action communication"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ros2 service"})," and ",(0,i.jsx)(n.code,{children:"ros2 action"})," tools: Command line tools for service and action management"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"simulation-vs-real-robot-activities",children:"Simulation vs Real-Robot Activities"}),"\n",(0,i.jsx)(n.h3,{id:"simulation",children:"Simulation:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Service calls for simulation control"}),"\n",(0,i.jsx)(n.li,{children:"Action-based navigation commands to simulated robots"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"real-robot",children:"Real Robot:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Action-based navigation commands to real robots"}),"\n",(0,i.jsx)(n.li,{children:"Service calls for hardware configuration and control"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"diagrams-and-figures",children:"Diagrams and Figures"}),"\n",(0,i.jsx)(n.h3,{id:"service-communication-sequence-diagram",children:"Service Communication Sequence Diagram"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Client          Server\n  |                |\n  |---request-----\x3e|\n  |                | Process request\n  |                | (blocking)\n  |<---response----|\n  |                |\n"})}),"\n",(0,i.jsx)(n.h3,{id:"action-lifecycle-diagram-with-feedback",children:"Action Lifecycle Diagram with Feedback"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Client           Server\n  |                 |\n  |---goal---------\x3e|\n  |                 | Accept goal\n  |<--accepted------|\n  |                 | Execute goal\n  |<--feedback------| (repeated)\n  |                 |\n  |<--result--------| (final)\n  |                 |\n"})}),"\n",(0,i.jsx)(n.h3,{id:"client-server-interaction-patterns",children:"Client-Server Interaction Patterns"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Services"}),": Synchronous request-response, immediate result"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Actions"}),": Asynchronous goal-feedback-result, long-running operations"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Topics"}),": Asynchronous publisher-subscriber, continuous data stream"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"checklists",children:"Checklists"}),"\n",(0,i.jsx)(n.h3,{id:"-service-interface-definition-checklist",children:"\u2713 Service Interface Definition Checklist"}),"\n",(0,i.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Service definition properly structured with request and response"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Dependencies properly declared in package.xml"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Service interface tested and validated"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"-action-interface-definition-checklist",children:"\u2713 Action Interface Definition Checklist"}),"\n",(0,i.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Action definition properly structured with goal, feedback, and result"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Appropriate data types selected for each component"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Action interface tested and validated"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"-client-implementation-validation-checklist",children:"\u2713 Client Implementation Validation Checklist"}),"\n",(0,i.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Client properly waits for service/action server"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Asynchronous calls handled with appropriate callbacks"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Error handling implemented for failed requests"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"glossary-terms",children:"Glossary Terms"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Service"}),": A synchronous request/response communication pattern in ROS 2"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Action"}),": An asynchronous request/response communication pattern with feedback and status updates"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Request"}),": The data structure sent from client to server in service communication"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Response"}),": The data structure sent from server to client in service communication"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Goal"}),": The initial request sent to an action server"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Feedback"}),": Intermediate updates sent from action server during execution"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Result"}),": The final outcome sent from action server when execution completes"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Client"}),": A ROS 2 node that sends requests to services or goals to actions"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Server"}),": A ROS 2 node that processes service requests or action goals"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"cross-references",children:"Cross-References"}),"\n",(0,i.jsx)(o.A,{to:"/docs/module-1/chapter-2",title:"Chapter 2: Nodes, Topics, and Messages",type:"prerequisite",children:(0,i.jsx)(n.p,{children:"Understanding topics is essential before learning about services and actions."})}),"\n",(0,i.jsx)(o.A,{to:"/docs/module-1/chapter-4",title:"Chapter 4: Parameters and Launch Systems",type:"continuation",children:(0,i.jsx)(n.p,{children:"After mastering services and actions, learn about parameters and system orchestration."})}),"\n",(0,i.jsx)(o.A,{to:"/docs/module-3/chapter-1",title:"Module 3, Chapter 1: Introduction to NVIDIA Isaac Ecosystem",type:"application",children:(0,i.jsx)(n.p,{children:"Apply service and action patterns in AI-robot systems for control and coordination."})}),"\n",(0,i.jsx)(n.h2,{id:"optional-advanced-section",children:"Optional Advanced Section"}),"\n",(0,i.jsx)(n.h3,{id:"multi-threaded-service-servers",children:"Multi-threaded Service Servers"}),"\n",(0,i.jsx)(n.p,{children:"Implementing service servers that can handle multiple requests concurrently."}),"\n",(0,i.jsx)(n.h3,{id:"custom-action-goal-preemption-logic",children:"Custom Action Goal Preemption Logic"}),"\n",(0,i.jsx)(n.p,{children:"Advanced action server implementation with goal preemption and queue management."}),"\n",(0,i.jsxs)(l.A,{type:"assignment",title:"Chapter 3 Assessment: Services and Actions",objectives:["Implement a service server for robot control","Create an action server for long-running goals","Develop clients to interact with services and actions","Handle feedback and results appropriately"],rubric:[{criterion:"Service Implementation",scores:[{label:"Excellent",value:"Service fully functional with proper error handling"},{label:"Proficient",value:"Service functional with minor issues"},{label:"Developing",value:"Service partially implemented"},{label:"Beginning",value:"Service not properly implemented"}]},{criterion:"Action Implementation",scores:[{label:"Excellent",value:"Action server with feedback fully functional"},{label:"Proficient",value:"Action server functional with minor issues"},{label:"Developing",value:"Action server partially implemented"},{label:"Beginning",value:"Action server not properly implemented"}]},{criterion:"Client Development",scores:[{label:"Excellent",value:"Clients properly handle async communication"},{label:"Proficient",value:"Clients functional with minor issues"},{label:"Developing",value:"Clients partially implemented"},{label:"Beginning",value:"Clients not properly implemented"}]}],children:[(0,i.jsx)(n.h3,{id:"assignment-tasks",children:"Assignment Tasks"}),(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Service Development"}),": Create a service that allows setting robot speed parameters with validation and error handling."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Action Implementation"}),": Implement an action server for path planning that provides feedback on progress and returns a complete path when finished."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Client Creation"}),": Develop client nodes that interact with both the service and action, handling responses and feedback appropriately."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Integration Testing"}),": Test the service and action in a simulated environment to verify proper communication patterns."]}),"\n"]}),"\n"]}),(0,i.jsx)(n.h3,{id:"submission-requirements",children:"Submission Requirements"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Source code for all service, action, and client implementations"}),"\n",(0,i.jsx)(n.li,{children:"Screenshots of successful service and action calls"}),"\n",(0,i.jsx)(n.li,{children:"Documentation of the communication patterns used"}),"\n",(0,i.jsx)(n.li,{children:"Reflection on when to use services vs. actions vs. topics"}),"\n"]})]}),"\n",(0,i.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,i.jsx)(a.A,{id:"ros2-services-actions-2021",authors:"Open Robotics",year:"2021",title:"ROS 2 Services and Actions Design",source:"ROS 2 Documentation",url:"https://docs.ros.org/en/rolling/Concepts/About-Actions.html",children:(0,i.jsx)(n.p,{children:"The official ROS 2 documentation on services and actions explaining their design and usage."})})]})}function v(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(_,{...e})}):_(e)}},7944(e,n,s){s.d(n,{A:()=>p});s(6540);var i=s(4164);const t="container_MRjH",r="citationContent_jj7V",c="citationText_bXIf",o="citationId_auqD",a="urlLink_ZvkM",l="description_pgVT",d="icon_HjvY";var u=s(4848);const p=({id:e,authors:n,year:s,title:p,source:h,url:m,children:_})=>(0,u.jsxs)("div",{className:(0,i.A)("citation-container",t),children:[(0,u.jsxs)("div",{className:r,children:[(0,u.jsxs)("div",{className:c,children:[(0,u.jsxs)("span",{className:o,children:["[",e,"]"]})," ",n," (",s,"). ",p,". ",h,".",m&&" Available at: ",m&&(0,u.jsx)("a",{href:m,className:a,target:"_blank",rel:"noopener noreferrer",children:m})]}),_&&(0,u.jsx)("div",{className:l,children:_})]}),(0,u.jsx)("span",{className:d,children:"\ud83d\udcda"})]})},8415(e,n,s){s.d(n,{A:()=>u});s(6540);var i=s(4164);const t="container_IT7u",r="header_CZcX",c="icon_E6M3",o="title_MIoE",a="objectivesList_NPeG",l="objectiveItem_Pr17";var d=s(4848);const u=({objectives:e,title:n="Learning Objectives"})=>(0,d.jsxs)("div",{className:(0,i.A)("learning-objectives-container",t),children:[(0,d.jsxs)("div",{className:r,children:[(0,d.jsx)("span",{className:c,children:"\ud83c\udfaf"}),(0,d.jsx)("h3",{className:o,children:n})]}),(0,d.jsx)("ul",{className:a,children:e.map((e,n)=>(0,d.jsx)("li",{className:l,children:e},n))})]})},8453(e,n,s){s.d(n,{R:()=>c,x:()=>o});var i=s(6540);const t={},r=i.createContext(t);function c(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);