"use strict";(globalThis.webpackChunkphysical_ai_robotics_book=globalThis.webpackChunkphysical_ai_robotics_book||[]).push([[658],{1473(e,s,n){n.d(s,{A:()=>u});n(6540);var i=n(4164);const r="container_DYDm",t="header_yOrC",l="titleSection_jiBk",a="icon_OiJW",o="title_bD_B",c="meta_N7Me",d="time_Cevp",h="difficulty_aRrW",p="content_CCam";var m=n(4848);const u=({title:e,time:s,difficulty:n,children:u})=>(0,m.jsxs)("div",{className:(0,i.A)("lab-activity-container",r),children:[(0,m.jsxs)("div",{className:t,children:[(0,m.jsxs)("div",{className:l,children:[(0,m.jsx)("span",{className:a,children:"\ud83e\uddea"}),(0,m.jsx)("h3",{className:o,children:e||"Lab Activity"})]}),(0,m.jsxs)("div",{className:c,children:[s&&(0,m.jsxs)("span",{className:d,children:["\u23f1\ufe0f ",s]}),n&&(0,m.jsxs)("span",{className:h,children:["\ud83c\udfaf ",n]})]})]}),(0,m.jsx)("div",{className:p,children:u})]})},3466(e,s,n){n.d(s,{A:()=>p});n(6540);var i=n(4164),r=n(5489);const t="container_wR2L",l="content_Ku25",a="refType_eLMv",o="refLink_Ya_s",c="description_kDwm",d="icon_D_OF";var h=n(4848);const p=({to:e,title:s,type:n="section",children:p})=>(0,h.jsxs)("div",{className:(0,i.A)("cross-reference-container",t),children:[(0,h.jsxs)("div",{className:l,children:[(0,h.jsxs)("span",{className:a,children:[n.toUpperCase(),":"]}),(0,h.jsx)(r.A,{to:e,className:o,children:s}),p&&(0,h.jsx)("div",{className:c,children:p})]}),(0,h.jsx)("span",{className:d,children:"\ud83d\udd17"})]})},8415(e,s,n){n.d(s,{A:()=>h});n(6540);var i=n(4164);const r="container_IT7u",t="header_CZcX",l="icon_E6M3",a="title_MIoE",o="objectivesList_NPeG",c="objectiveItem_Pr17";var d=n(4848);const h=({objectives:e,title:s="Learning Objectives"})=>(0,d.jsxs)("div",{className:(0,i.A)("learning-objectives-container",r),children:[(0,d.jsxs)("div",{className:t,children:[(0,d.jsx)("span",{className:l,children:"\ud83c\udfaf"}),(0,d.jsx)("h3",{className:a,children:s})]}),(0,d.jsx)("ul",{className:o,children:e.map((e,s)=>(0,d.jsx)("li",{className:c,children:e},s))})]})},8453(e,s,n){n.d(s,{R:()=>l,x:()=>a});var i=n(6540);const r={},t=i.createContext(r);function l(e){const s=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:s},e.children)}},9779(e,s,n){n.r(s),n.d(s,{assets:()=>h,contentTitle:()=>c,default:()=>u,frontMatter:()=>o,metadata:()=>d,toc:()=>p});var i=n(4848),r=n(8453),t=n(8415),l=n(1473),a=n(3466);const o={sidebar_position:3},c="Chapter 2: Nodes, Topics, and Messages",d={id:"module-1/chapter-2",title:"Chapter 2: Nodes, Topics, and Messages",description:"Chapter Purpose",source:"@site/docs/module-1/chapter-2.md",sourceDirName:"module-1",slug:"/module-1/chapter-2",permalink:"/hackathon_project1/docs/module-1/chapter-2",draft:!1,unlisted:!1,editUrl:"https://github.com/physical-ai-robotics-book/physical-ai-robotics-book/tree/main/docusaurus/docs/module-1/chapter-2.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"textbookSidebar",previous:{title:"Chapter 1: Introduction to ROS 2 Architecture",permalink:"/hackathon_project1/docs/module-1/chapter-1"},next:{title:"Chapter 3: Services and Actions",permalink:"/hackathon_project1/docs/module-1/chapter-3"}},h={},p=[{value:"Chapter Purpose",id:"chapter-purpose",level:2},{value:"Key Concepts",id:"key-concepts",level:2},{value:"Practical Demonstrations",id:"practical-demonstrations",level:2},{value:"1. Creating Simple Publisher and Subscriber Nodes",id:"1-creating-simple-publisher-and-subscriber-nodes",level:3},{value:"2. Message Introspection and Debugging",id:"2-message-introspection-and-debugging",level:3},{value:"3. QoS Profile Comparison and Selection",id:"3-qos-profile-comparison-and-selection",level:3},{value:"Hands-on Coding Labs",id:"hands-on-coding-labs",level:2},{value:"Objective",id:"objective",level:3},{value:"Steps",id:"steps",level:3},{value:"Expected Outcome",id:"expected-outcome",level:3},{value:"Troubleshooting Tips",id:"troubleshooting-tips",level:3},{value:"Objective",id:"objective-1",level:3},{value:"Steps",id:"steps-1",level:3},{value:"Expected Outcome",id:"expected-outcome-1",level:3},{value:"Troubleshooting Tips",id:"troubleshooting-tips-1",level:3},{value:"Objective",id:"objective-2",level:3},{value:"Steps",id:"steps-2",level:3},{value:"Expected Outcome",id:"expected-outcome-2",level:3},{value:"Troubleshooting Tips",id:"troubleshooting-tips-2",level:3},{value:"ROS 2 Packages/Tools Used",id:"ros-2-packagestools-used",level:2},{value:"Simulation vs Real-Robot Activities",id:"simulation-vs-real-robot-activities",level:2},{value:"Simulation:",id:"simulation",level:3},{value:"Real Robot:",id:"real-robot",level:3},{value:"Diagrams and Figures",id:"diagrams-and-figures",level:2},{value:"Publisher-Subscriber Communication Flow",id:"publisher-subscriber-communication-flow",level:3},{value:"Message Type Hierarchy Diagram",id:"message-type-hierarchy-diagram",level:3},{value:"QoS Profile Comparison Chart",id:"qos-profile-comparison-chart",level:3},{value:"Checklists",id:"checklists",level:2},{value:"\u2713 Node Creation and Lifecycle Validation Checklist",id:"-node-creation-and-lifecycle-validation-checklist",level:3},{value:"\u2713 Message Type Definition Checklist",id:"-message-type-definition-checklist",level:3},{value:"\u2713 QoS Profile Selection Checklist",id:"-qos-profile-selection-checklist",level:3},{value:"Glossary Terms",id:"glossary-terms",level:2},{value:"Cross-References",id:"cross-references",level:2},{value:"Optional Advanced Section",id:"optional-advanced-section",level:2},{value:"Custom Serialization and Deserialization",id:"custom-serialization-and-deserialization",level:3},{value:"Performance Optimization for High-Frequency Topics",id:"performance-optimization-for-high-frequency-topics",level:3},{value:"Exercises",id:"exercises",level:2}];function m(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.h1,{id:"chapter-2-nodes-topics-and-messages",children:"Chapter 2: Nodes, Topics, and Messages"}),"\n","\n","\n",(0,i.jsx)(s.h2,{id:"chapter-purpose",children:"Chapter Purpose"}),"\n",(0,i.jsx)(s.p,{children:"This chapter covers the fundamental communication mechanism in ROS 2 using publishers and subscribers. Students will master the publisher-subscriber communication pattern, understand message types and serialization, and learn about Quality of Service (QoS) profiles and their impact on system performance and reliability."}),"\n",(0,i.jsx)(t.A,{objectives:["Design and implement ROS 2 nodes in both Python and C++ for robot control and perception","Configure and manage ROS 2 communication patterns including publisher-subscriber interactions","Create and use custom message types for specialized data","Configure appropriate QoS profiles for different communication requirements","Debug and monitor topic-based communication in ROS 2 systems"]}),"\n",(0,i.jsx)(s.h2,{id:"key-concepts",children:"Key Concepts"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Node lifecycle and management"}),": Understanding the ROS 2 node lifecycle and proper resource management"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Publisher-subscriber communication pattern"}),": The core asynchronous communication mechanism in ROS 2"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Message types and serialization"}),": Understanding how data is structured and serialized for transmission"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Quality of Service (QoS) profiles"}),": Configuring communication behavior for different reliability and performance requirements"]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"practical-demonstrations",children:"Practical Demonstrations"}),"\n",(0,i.jsx)(s.h3,{id:"1-creating-simple-publisher-and-subscriber-nodes",children:"1. Creating Simple Publisher and Subscriber Nodes"}),"\n",(0,i.jsx)(s.p,{children:"Creating a publisher node that publishes sensor data:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"# publisher_member_function.py\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass MinimalPublisher(Node):\n    def __init__(self):\n        super().__init__('minimal_publisher')\n        self.publisher_ = self.create_publisher(String, 'topic', 10)\n        timer_period = 0.5  # seconds\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n        self.i = 0\n\n    def timer_callback(self):\n        msg = String()\n        msg.data = 'Hello World: %d' % self.i\n        self.publisher_.publish(msg)\n        self.get_logger().info('Publishing: \"%s\"' % msg.data)\n        self.i += 1\n\ndef main(args=None):\n    rclpy.init(args=args)\n    minimal_publisher = MinimalPublisher()\n    rclpy.spin(minimal_publisher)\n    minimal_publisher.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(s.p,{children:"Creating a subscriber node that receives and processes messages:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"# subscriber_member_function.py\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass MinimalSubscriber(Node):\n    def __init__(self):\n        super().__init__('minimal_subscriber')\n        self.subscription = self.create_subscription(\n            String,\n            'topic',\n            self.listener_callback,\n            10)\n        self.subscription  # prevent unused variable warning\n\n    def listener_callback(self, msg):\n        self.get_logger().info('I heard: \"%s\"' % msg.data)\n\ndef main(args=None):\n    rclpy.init(args=args)\n    minimal_subscriber = MinimalSubscriber()\n    rclpy.spin(minimal_subscriber)\n    minimal_subscriber.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(s.h3,{id:"2-message-introspection-and-debugging",children:"2. Message Introspection and Debugging"}),"\n",(0,i.jsx)(s.p,{children:"Using ROS 2 command line tools to inspect messages:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"# List all topics\nros2 topic list\n\n# Echo messages on a topic\nros2 topic echo /topic std_msgs/msg/String\n\n# Get information about a topic\nros2 topic info /topic\n\n# Publish a message from command line\nros2 topic pub /topic std_msgs/String \"data: 'Hello from CLI'\"\n"})}),"\n",(0,i.jsx)(s.h3,{id:"3-qos-profile-comparison-and-selection",children:"3. QoS Profile Comparison and Selection"}),"\n",(0,i.jsx)(s.p,{children:"Understanding different QoS profiles:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"from rclpy.qos import QoSProfile, QoSDurabilityPolicy, QoSHistoryPolicy, QoSReliabilityPolicy\n\n# Reliable communication with queue size of 10\nqos_profile = QoSProfile(\n    depth=10,\n    durability=QoSDurabilityPolicy.VOLATILE,\n    history=QoSHistoryPolicy.KEEP_LAST,\n    reliability=QoSReliabilityPolicy.RELIABLE\n)\n\n# Best effort for real-time sensor data\nsensor_qos = QoSProfile(\n    depth=5,\n    durability=QoSDurabilityPolicy.VOLATILE,\n    history=QoSHistoryPolicy.KEEP_LAST,\n    reliability=QoSReliabilityPolicy.BEST_EFFORT\n)\n"})}),"\n",(0,i.jsx)(s.h2,{id:"hands-on-coding-labs",children:"Hands-on Coding Labs"}),"\n",(0,i.jsxs)(l.A,{title:"Lab 2.1: Implementing a Sensor Data Publisher (Simulated IMU)",time:"45 min",difficulty:"Medium",children:[(0,i.jsx)(s.h3,{id:"objective",children:"Objective"}),(0,i.jsx)(s.p,{children:"Create a ROS 2 publisher node that simulates IMU sensor data and publishes it to a topic."}),(0,i.jsx)(s.h3,{id:"steps",children:"Steps"}),(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Create a new Python file for the IMU publisher:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"mkdir -p ~/ros2_ws/src/imu_publisher/imu_publisher\ntouch ~/ros2_ws/src/imu_publisher/imu_publisher/imu_publisher_node.py\n"})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Add the following code to ",(0,i.jsx)(s.code,{children:"imu_publisher_node.py"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import Imu\nimport math\n\nclass ImuPublisher(Node):\n    def __init__(self):\n        super().__init__('imu_publisher')\n        self.publisher_ = self.create_publisher(Imu, 'imu/data', 10)\n        timer_period = 0.1  # 10Hz\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n        self.i = 0\n\n    def timer_callback(self):\n        msg = Imu()\n        # Simulate IMU data\n        msg.orientation.x = 0.0\n        msg.orientation.y = 0.0\n        msg.orientation.z = math.sin(self.i * 0.1)\n        msg.orientation.w = math.cos(self.i * 0.1)\n\n        msg.angular_velocity.x = 0.1\n        msg.angular_velocity.y = 0.05\n        msg.angular_velocity.z = 0.02\n\n        msg.linear_acceleration.x = 0.5\n        msg.linear_acceleration.y = 0.2\n        msg.linear_acceleration.z = 9.81  # gravity\n\n        self.publisher_.publish(msg)\n        self.get_logger().info(f'Publishing IMU data: {self.i}')\n        self.i += 1\n\ndef main(args=None):\n    rclpy.init(args=args)\n    imu_publisher = ImuPublisher()\n    rclpy.spin(imu_publisher)\n    imu_publisher.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Create a setup.py file for the package:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"from setuptools import find_packages, setup\n\npackage_name = 'imu_publisher'\n\nsetup(\n    name=package_name,\n    version='0.0.0',\n    packages=find_packages(exclude=['test']),\n    data_files=[\n        ('share/ament_index/resource_index/packages',\n            ['resource/' + package_name]),\n        ('share/' + package_name, ['package.xml']),\n    ],\n    install_requires=['setuptools'],\n    zip_safe=True,\n    maintainer='Your Name',\n    maintainer_email='your.email@example.com',\n    description='A simple IMU publisher for ROS 2',\n    license='Apache-2.0',\n    tests_require=['pytest'],\n    entry_points={\n        'console_scripts': [\n            'imu_publisher = imu_publisher.imu_publisher_node:main',\n        ],\n    },\n)\n"})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Create a package.xml file:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<?xml-model href="http://download.ros.org/schema/package_format3.xsd" schematypens="http://www.w3.org/2001/XMLSchema"?>\n<package format="3">\n  <name>imu_publisher</name>\n  <version>0.0.0</version>\n  <description>A simple IMU publisher for ROS 2</description>\n  <maintainer email="your.email@example.com">Your Name</maintainer>\n  <license>Apache-2.0</license>\n\n  <depend>rclpy</depend>\n  <depend>sensor_msgs</depend>\n\n  <test_depend>ament_copyright</test_depend>\n  <test_depend>ament_flake8</test_depend>\n  <test_depend>ament_pep257</test_depend>\n  <test_depend>python3-pytest</test_depend>\n\n  <export>\n    <build_type>ament_python</build_type>\n  </export>\n</package>\n'})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Build the package:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"cd ~/ros2_ws\ncolcon build --packages-select imu_publisher\nsource install/setup.bash\n"})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Run the publisher:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"ros2 run imu_publisher imu_publisher\n"})}),"\n"]}),"\n"]}),(0,i.jsx)(s.h3,{id:"expected-outcome",children:"Expected Outcome"}),(0,i.jsxs)(s.p,{children:["The IMU publisher node runs and publishes simulated IMU data to the ",(0,i.jsx)(s.code,{children:"/imu/data"})," topic at 10Hz."]}),(0,i.jsx)(s.h3,{id:"troubleshooting-tips",children:"Troubleshooting Tips"}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Ensure all dependencies are properly declared in package.xml"}),"\n",(0,i.jsx)(s.li,{children:"Check that the topic name matches between publisher and any subscribers"}),"\n"]})]}),"\n",(0,i.jsxs)(l.A,{title:"Lab 2.2: Creating a Subscriber to Visualize Sensor Data",time:"45 min",difficulty:"Medium",children:[(0,i.jsx)(s.h3,{id:"objective-1",children:"Objective"}),(0,i.jsx)(s.p,{children:"Create a ROS 2 subscriber node that receives IMU data and processes it to extract meaningful information."}),(0,i.jsx)(s.h3,{id:"steps-1",children:"Steps"}),(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Create a new Python file for the IMU subscriber:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"touch ~/ros2_ws/src/imu_publisher/imu_publisher/imu_subscriber_node.py\n"})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Add the following code to ",(0,i.jsx)(s.code,{children:"imu_subscriber_node.py"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import Imu\nimport math\n\nclass ImuSubscriber(Node):\n    def __init__(self):\n        super().__init__('imu_subscriber')\n        self.subscription = self.create_subscription(\n            Imu,\n            'imu/data',\n            self.imu_callback,\n            10)\n        self.subscription  # prevent unused variable warning\n\n    def imu_callback(self, msg):\n        # Calculate yaw from quaternion\n        quat = msg.orientation\n        siny_cosp = 2 * (quat.w * quat.z + quat.x * quat.y)\n        cosy_cosp = 1 - 2 * (quat.y * quat.y + quat.z * quat.z)\n        yaw = math.atan2(siny_cosp, cosy_cosp)\n\n        self.get_logger().info(f'Yaw: {math.degrees(yaw):.2f}\xb0, '\n                              f'Accel Z: {msg.linear_acceleration.z:.2f} m/s\xb2')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    imu_subscriber = ImuSubscriber()\n    rclpy.spin(imu_subscriber)\n    imu_subscriber.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Update the setup.py to include the new executable:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"entry_points={\n    'console_scripts': [\n        'imu_publisher = imu_publisher.imu_publisher_node:main',\n        'imu_subscriber = imu_publisher.imu_subscriber_node:main',\n    ],\n},\n"})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Build and source the workspace:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"cd ~/ros2_ws\ncolcon build --packages-select imu_publisher\nsource install/setup.bash\n"})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"In one terminal, run the publisher:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"ros2 run imu_publisher imu_publisher\n"})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"In another terminal, run the subscriber:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"ros2 run imu_publisher imu_subscriber\n"})}),"\n"]}),"\n"]}),(0,i.jsx)(s.h3,{id:"expected-outcome-1",children:"Expected Outcome"}),(0,i.jsx)(s.p,{children:"The subscriber node receives IMU data from the publisher and logs processed information including yaw angle and acceleration values."}),(0,i.jsx)(s.h3,{id:"troubleshooting-tips-1",children:"Troubleshooting Tips"}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Ensure both nodes are using the same topic name"}),"\n",(0,i.jsx)(s.li,{children:"Check that QoS profiles are compatible between publisher and subscriber"}),"\n"]})]}),"\n",(0,i.jsxs)(l.A,{title:"Lab 2.3: Implementing Custom Message Types for Specialized Data",time:"60 min",difficulty:"Hard",children:[(0,i.jsx)(s.h3,{id:"objective-2",children:"Objective"}),(0,i.jsx)(s.p,{children:"Create custom message types for specialized robot data and use them in publisher-subscriber communication."}),(0,i.jsx)(s.h3,{id:"steps-2",children:"Steps"}),(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Create a new package for custom messages:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"cd ~/ros2_ws/src\nros2 pkg create --build-type ament_cmake robot_msgs\n"})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Create msg directory and define a custom message:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"mkdir -p ~/ros2_ws/src/robot_msgs/msg\n"})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Create ",(0,i.jsx)(s.code,{children:"RobotStatus.msg"})," file:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"# ~/ros2_ws/src/robot_msgs/msg/RobotStatus.msg\nuint8 STATE_IDLE=0\nuint8 STATE_MOVING=1\nuint8 STATE_ERROR=2\n\nuint8 state\nfloat64 battery_level\nstring current_action\nfloat64[] joint_positions\n"})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Update CMakeLists.txt to include message generation:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-cmake",children:'find_package(rosidl_default_generators REQUIRED)\n\nrosidl_generate_interfaces(${PROJECT_NAME}\n  "msg/RobotStatus.msg"\n)\n\nament_export_dependencies(rosidl_default_runtime)\n'})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Update package.xml to include message dependencies:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-xml",children:"<depend>std_msgs</depend>\n<member_of_group>rosidl_interface_packages</member_of_group>\n"})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Build the message package:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"cd ~/ros2_ws\ncolcon build --packages-select robot_msgs\nsource install/setup.bash\n"})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Create a publisher using the custom message:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"# ~/ros2_ws/src/robot_msgs/robot_msgs/robot_status_publisher.py\nimport rclpy\nfrom rclpy.node import Node\nfrom robot_msgs.msg import RobotStatus\n\nclass RobotStatusPublisher(Node):\n    def __init__(self):\n        super().__init__('robot_status_publisher')\n        self.publisher_ = self.create_publisher(RobotStatus, 'robot_status', 10)\n        timer_period = 1.0  # seconds\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n        self.i = 0\n\n    def timer_callback(self):\n        msg = RobotStatus()\n        msg.state = RobotStatus.STATE_MOVING if self.i % 3 != 0 else RobotStatus.STATE_IDLE\n        msg.battery_level = 100.0 - (self.i * 0.1)\n        msg.current_action = f'Moving to position {self.i}'\n        msg.joint_positions = [float(i), float(i+1), float(i+2)]\n\n        self.publisher_.publish(msg)\n        self.get_logger().info(f'Publishing: {msg.current_action}')\n        self.i += 1\n\ndef main(args=None):\n    rclpy.init(args=args)\n    robot_status_publisher = RobotStatusPublisher()\n    rclpy.spin(robot_status_publisher)\n    robot_status_publisher.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Build and test the custom message:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"colcon build --packages-select robot_msgs\nsource install/setup.bash\nros2 run robot_msgs robot_status_publisher  # This would need to be set up properly\n"})}),"\n"]}),"\n"]}),(0,i.jsx)(s.h3,{id:"expected-outcome-2",children:"Expected Outcome"}),(0,i.jsx)(s.p,{children:"Custom message types are defined, built, and can be used in ROS 2 publisher-subscriber communication."}),(0,i.jsx)(s.h3,{id:"troubleshooting-tips-2",children:"Troubleshooting Tips"}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Ensure the message definition file has the correct syntax"}),"\n",(0,i.jsx)(s.li,{children:"Check that all dependencies are properly declared in package.xml and CMakeLists.txt"}),"\n"]})]}),"\n",(0,i.jsx)(s.h2,{id:"ros-2-packagestools-used",children:"ROS 2 Packages/Tools Used"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"std_msgs"}),": Standard message types for basic data (String, Int, Float, etc.)"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"geometry_msgs"}),": Message types for geometry (Point, Pose, Vector3, etc.)"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"sensor_msgs"}),": Message types for sensors (Imu, LaserScan, Image, etc.)"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"rclpy"})," and ",(0,i.jsx)(s.code,{children:"rclcpp"})," libraries: ROS 2 client libraries for Python and C++"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"ros2 topic"})," and ",(0,i.jsx)(s.code,{children:"ros2 msg"})," tools: Command line tools for topic and message management"]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"simulation-vs-real-robot-activities",children:"Simulation vs Real-Robot Activities"}),"\n",(0,i.jsx)(s.h3,{id:"simulation",children:"Simulation:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Publishing simulated sensor data from Gazebo"}),"\n",(0,i.jsx)(s.li,{children:"Testing communication patterns in virtual environments"}),"\n",(0,i.jsx)(s.li,{children:"Validating message formats and QoS settings"}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"real-robot",children:"Real Robot:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Connecting to actual IMU and publishing real sensor data"}),"\n",(0,i.jsx)(s.li,{children:"Testing with actual hardware constraints and limitations"}),"\n",(0,i.jsx)(s.li,{children:"Validating performance under real-world conditions"}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"diagrams-and-figures",children:"Diagrams and Figures"}),"\n",(0,i.jsx)(s.h3,{id:"publisher-subscriber-communication-flow",children:"Publisher-Subscriber Communication Flow"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"+----------------+                    +------------------+\n|   Publisher    |  ------\x3e Topic -----\x3e   Subscriber    |\n|                |                    |                  |\n| - Creates msg  |                    | - Receives msg   |\n| - Publishes    |                    | - Processes msg  |\n| - Manages node |                    | - Callback func  |\n+----------------+                    +------------------+\n"})}),"\n",(0,i.jsx)(s.h3,{id:"message-type-hierarchy-diagram",children:"Message Type Hierarchy Diagram"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"Base Message Types\n\u251c\u2500\u2500 std_msgs/\n\u2502   \u251c\u2500\u2500 String, Int, Float, etc.\n\u2502   \u2514\u2500\u2500 Common primitive types\n\u251c\u2500\u2500 geometry_msgs/\n\u2502   \u251c\u2500\u2500 Point, Pose, Vector3\n\u2502   \u2514\u2500\u2500 Transformations\n\u251c\u2500\u2500 sensor_msgs/\n\u2502   \u251c\u2500\u2500 Imu, LaserScan, Image\n\u2502   \u2514\u2500\u2500 Sensor data types\n\u2514\u2500\u2500 custom_msgs/\n    \u2514\u2500\u2500 Application-specific types\n"})}),"\n",(0,i.jsx)(s.h3,{id:"qos-profile-comparison-chart",children:"QoS Profile Comparison Chart"}),"\n",(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Profile"}),(0,i.jsx)(s.th,{children:"Reliability"}),(0,i.jsx)(s.th,{children:"Durability"}),(0,i.jsx)(s.th,{children:"History"}),(0,i.jsx)(s.th,{children:"Use Case"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Sensor Data"}),(0,i.jsx)(s.td,{children:"Best Effort"}),(0,i.jsx)(s.td,{children:"Volatile"}),(0,i.jsx)(s.td,{children:"Keep Last"}),(0,i.jsx)(s.td,{children:"Real-time sensor streams"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Command"}),(0,i.jsx)(s.td,{children:"Reliable"}),(0,i.jsx)(s.td,{children:"Volatile"}),(0,i.jsx)(s.td,{children:"Keep Last"}),(0,i.jsx)(s.td,{children:"Robot commands"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Configuration"}),(0,i.jsx)(s.td,{children:"Reliable"}),(0,i.jsx)(s.td,{children:"Transient Local"}),(0,i.jsx)(s.td,{children:"Keep All"}),(0,i.jsx)(s.td,{children:"System parameters"})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.td,{children:"Log"}),(0,i.jsx)(s.td,{children:"Reliable"}),(0,i.jsx)(s.td,{children:"Persistent"}),(0,i.jsx)(s.td,{children:"Keep All"}),(0,i.jsx)(s.td,{children:"Event logging"})]})]})]}),"\n",(0,i.jsx)(s.h2,{id:"checklists",children:"Checklists"}),"\n",(0,i.jsx)(s.h3,{id:"-node-creation-and-lifecycle-validation-checklist",children:"\u2713 Node Creation and Lifecycle Validation Checklist"}),"\n",(0,i.jsxs)(s.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Node properly initialized with correct name"]}),"\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","All resources properly created and configured"]}),"\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Cleanup methods implemented for graceful shutdown"]}),"\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Error handling implemented for edge cases"]}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"-message-type-definition-checklist",children:"\u2713 Message Type Definition Checklist"}),"\n",(0,i.jsxs)(s.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Appropriate standard message types used when available"]}),"\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Custom message definitions properly structured"]}),"\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Message dependencies properly declared"]}),"\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Message validation implemented"]}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"-qos-profile-selection-checklist",children:"\u2713 QoS Profile Selection Checklist"}),"\n",(0,i.jsxs)(s.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","QoS profile appropriate for data type and requirements"]}),"\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Reliability setting matches use case (reliable vs best effort)"]}),"\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Durability setting appropriate for publisher/subscriber relationship"]}),"\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","History policy and depth properly configured"]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"glossary-terms",children:"Glossary Terms"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Publisher"}),": A ROS 2 node that sends messages on a topic"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Subscriber"}),": A ROS 2 node that receives messages from a topic"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Message"}),": The data structure exchanged between nodes"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"QoS (Quality of Service)"}),": Configuration parameters that define communication behavior"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Callback"}),": Function executed when a message is received"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Rate"}),": Frequency at which messages are published"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Spin"}),": Process of checking for and processing messages"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Topic"}),": Named bus over which messages are exchanged"]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"cross-references",children:"Cross-References"}),"\n",(0,i.jsx)(a.A,{to:"/docs/module-1/chapter-1",title:"Chapter 1: Introduction to ROS 2 Architecture",type:"prerequisite",children:(0,i.jsx)(s.p,{children:"Review the basic ROS 2 architecture concepts before diving into nodes and topics."})}),"\n",(0,i.jsx)(a.A,{to:"/docs/module-1/chapter-3",title:"Chapter 3: Services and Actions",type:"continuation",children:(0,i.jsx)(s.p,{children:"After mastering topics, continue with services and actions for synchronous communication."})}),"\n",(0,i.jsx)(a.A,{to:"/docs/module-2/chapter-1",title:"Module 2, Chapter 1: Introduction to Simulation Environments",type:"application",children:(0,i.jsx)(s.p,{children:"Apply node and topic concepts in simulation environments to test your implementations."})}),"\n",(0,i.jsx)(s.h2,{id:"optional-advanced-section",children:"Optional Advanced Section"}),"\n",(0,i.jsx)(s.h3,{id:"custom-serialization-and-deserialization",children:"Custom Serialization and Deserialization"}),"\n",(0,i.jsx)(s.p,{children:"Implementing custom message serialization for performance-critical applications."}),"\n",(0,i.jsx)(s.h3,{id:"performance-optimization-for-high-frequency-topics",children:"Performance Optimization for High-Frequency Topics"}),"\n",(0,i.jsx)(s.p,{children:"Techniques for optimizing message publishing at high frequencies (>1kHz)."}),"\n",(0,i.jsx)(s.h2,{id:"exercises",children:"Exercises"}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Basic Publisher-Subscriber"}),": Create a simple publisher-subscriber pair that exchanges messages at 1Hz"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"QoS Experimentation"}),": Compare different QoS profiles and observe their effects on message delivery"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Custom Message"}),": Define and use a custom message type for a specific robot application"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Performance Testing"}),": Measure and optimize the performance of high-frequency message publishing"]}),"\n"]})]})}function u(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(m,{...e})}):m(e)}}}]);